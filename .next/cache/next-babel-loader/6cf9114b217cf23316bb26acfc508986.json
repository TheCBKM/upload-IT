{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) { return function () { var Super = _getPrototypeOf(Derived), result; if (_isNativeReflectConstruct()) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport ipfs from '../ipfs';\nimport React, { Component } from 'react';\nvar accepts = [{\n  name: \"images\",\n  acc: \"image/*\"\n}, {\n  name: \"audio\",\n  acc: \"audio/*\"\n}, {\n  name: \"pdf\",\n  acc: \"application/pdf,application/msword,\"\n}];\nexport var index = /*#__PURE__*/function (_Component) {\n  _inherits(index, _Component);\n\n  var _super = _createSuper(index);\n\n  function index() {\n    var _this;\n\n    _classCallCheck(this, index);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      file: null,\n      ipfsHash: null,\n      fileformat: \"null\",\n      fileLoaded: false,\n      formatLoaded: false\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"captureChange\", function (event) {\n      console.log(\"caputreFile\");\n      event.preventDefault();\n      var file = event.target.files[0];\n      var reader = new window.FileReader();\n      reader.readAsArrayBuffer(file);\n\n      reader.onloadend = function () {\n        _this.setState({\n          file: Buffer(reader.result),\n          fileLoaded: true\n        });\n\n        console.log('buffer', _this.state.file);\n      };\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"submit\", function _callee2() {\n      return _regeneratorRuntime.async(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              event.preventDefault();\n              console.log(\"onSubmit\");\n              ipfs.files.add(_this.state.file, function _callee(err, res) {\n                return _regeneratorRuntime.async(function _callee$(_context) {\n                  while (1) {\n                    switch (_context.prev = _context.next) {\n                      case 0:\n                        if (!err) {\n                          _context.next = 4;\n                          break;\n                        }\n\n                        console.error(err);\n                        console.log(\"error\");\n                        return _context.abrupt(\"return\");\n\n                      case 4:\n                        _context.next = 6;\n                        return _regeneratorRuntime.awrap(_this.setState({\n                          ipfsHash: res[0].hash,\n                          fileLoaded: true,\n                          formatLoaded: false\n                        }));\n\n                      case 6:\n                        console.log(res);\n                        console.log('ipfsHash', _this.state);\n\n                      case 8:\n                      case \"end\":\n                        return _context.stop();\n                    }\n                  }\n                }, null, null, null, Promise);\n              });\n\n            case 3:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"format\", function _callee3(event) {\n      var value, format;\n      return _regeneratorRuntime.async(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              value = event.target.value;\n\n              if (!(value == \"Choose....\")) {\n                _context3.next = 5;\n                break;\n              }\n\n              _context3.next = 4;\n              return _regeneratorRuntime.awrap(_this.setState({\n                formatLoaded: false\n              }));\n\n            case 4:\n              return _context3.abrupt(\"return\");\n\n            case 5:\n              format = accepts.find(function (a) {\n                return a.name == value;\n              }).acc;\n              _context3.next = 8;\n              return _regeneratorRuntime.awrap(_this.setState({\n                fileformat: format ? format : null,\n                formatLoaded: true,\n                file: null,\n                ipfsHash: null,\n                fileLoaded: false\n              }));\n\n            case 8:\n              console.log(_this.state);\n\n            case 9:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    });\n\n    return _this;\n  }\n\n  _createClass(index, [{\n    key: \"render\",\n    value: function render() {\n      return __jsx(\"div\", null, __jsx(\"select\", {\n        onChange: this.format\n      }, __jsx(\"option\", null, \"Choose....\"), accepts.map(function (a) {\n        return __jsx(\"option\", null, a.name);\n      })), __jsx(\"br\", null), this.state.formatLoaded ? __jsx(\"div\", null, __jsx(\"input\", {\n        type: \"file\",\n        multiple: true,\n        onChange: this.captureChange,\n        accept: this.state.fileformat\n      }), __jsx(\"br\", null), this.state.fileLoaded ? __jsx(\"button\", {\n        onClick: this.submit\n      }, \"Submit\") : \"Load file\") : \"Select format\", __jsx(\"br\", null), this.state.ipfsHash ? __jsx(\"div\", null, __jsx(\"a\", {\n        href: \"https://ipfs.io/ipfs/\".concat(this.state.ipfsHash)\n      }, \"Link\"), __jsx(\"br\", null), this.state.fileformat == accepts[1].acc ? __jsx(\"audio\", {\n        controls: true\n      }, __jsx(\"source\", {\n        src: \"https://ipfs.io/ipfs/\".concat(this.state.ipfsHash),\n        type: \"audio/ogg\"\n      }), __jsx(\"source\", {\n        src: \"https://ipfs.io/ipfs/\".concat(this.state.ipfsHash),\n        type: \"audio/mpeg\"\n      }), \"Your browser does not support the audio element.\") : this.state.fileformat == accepts[0].acc ? __jsx(\"img\", {\n        src: \"https://ipfs.io/ipfs/\".concat(this.state.ipfsHash),\n        width: \"200\",\n        height: \"200\",\n        alt: \"Wait for image\"\n      }) : this.state.fileformat == accepts[2].acc ? __jsx(\"iframe\", {\n        src: \"https://ipfs.io/ipfs/\".concat(this.state.ipfsHash)\n      }) : \"\") : \"Upload some file\", __jsx(\"br\", null));\n    }\n  }]);\n\n  return index;\n}(Component);\nexport default index;","map":null,"metadata":{},"sourceType":"module"}